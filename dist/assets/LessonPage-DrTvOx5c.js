import{o as b,r as n,j as e,p as G,u as W,q as U,s as V,R as J}from"./index-B4goEG5b.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],O=b("ArrowLeft",K);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["line",{x1:"6",x2:"10",y1:"12",y2:"12",key:"161bw2"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"15",x2:"15.01",y1:"13",y2:"13",key:"dqpgro"}],["line",{x1:"18",x2:"18.01",y1:"11",y2:"11",key:"meh2c"}],["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]],X=b("Gamepad",Q);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],D=b("Mic",Y);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],te=b("Play",ee),se=({currentLesson:c,lessons:p})=>{const g=p[c],x=(g==null?void 0:g.expected)||"",h=`/images/${(d=>({अनार:"anaar",आम:"aam",इमली:"imli",ईख:"eekh",उल्लू:"ullu",ऊन:"oon",एप्पल:"apple",ऐनक:"ainak",ओखली:"okhli",औरत:"aurat",अंगूर:"angoor"})[d]||d.toLowerCase())(x)}.png`;return n.useEffect(()=>{c&&c!==0&&(console.log("Current lesson:",c),console.log("Current word:",x),console.log("Image path:",h))},[c,x,h]),!c||c===0?null:e.jsx("div",{className:"absolute top-12 right-16 z-40 pointer-events-none",children:e.jsx("div",{className:"relative",children:e.jsx("div",{className:"flex items-center justify-center w-20 h-20 bg-white rounded-full shadow-lg animate-bounce-slow p-2",children:e.jsx("img",{src:h,alt:x,className:"max-w-[60px] max-h-[60px] w-auto h-auto object-contain rounded-full",onError:d=>{console.error(`Failed to load image: ${h}`),d.target.style.display="none",d.target.parentElement.innerHTML=`<div class="text-2xl text-orange-500">${x}</div>`}})})})})};function oe(){const c=G(),p=W(),{levelFile:g}=c.state||{levelFile:"swar.json"},{isTeaching:x,setIsTeaching:m,setIsClapping:h,setBowing:d}=U(),[w,j]=n.useState(""),[a,_]=n.useState([]),[i,C]=n.useState(0),[$,v]=n.useState(""),[A,N]=n.useState(""),[f,H]=n.useState(null),[ne,Z]=n.useState(""),[S,k]=n.useState(!0),[R,z]=n.useState(null),[L,y]=n.useState(!1),[r,T]=n.useState(!1);n.useEffect(()=>{(async()=>{try{k(!0);const t=await fetch(`/syllabus/${g}`);if(!t.ok)throw new Error("Failed to load lesson data");const l=await t.json();_(l),l.length>0&&(v(l[0].text),N(l[0].english)),k(!1)}catch(t){console.error("Error loading lessons:",t),z(t.message),k(!1)}})()},[g]),n.useEffect(()=>{const s=window.SpeechRecognition||window.webkitSpeechRecognition;if(s){const t=new s;t.lang="hi-IN",t.continuous=!1,t.interimResults=!1,H(t)}},[]),n.useEffect(()=>()=>{speechSynthesis.cancel()},[]);const u=n.useCallback(async(s,t)=>(speechSynthesis.cancel(),new Promise(l=>{var F,M;if(r){l();return}const o=new SpeechSynthesisUtterance(s);o.lang="hi-IN",o.rate=.9,o.pitch=1.1,o.volume=1,m(!0),T(!0),s===((F=a[0])==null?void 0:F.text)&&(d(!0),setTimeout(()=>d(!1),2e3));const P=(M=s.split("।")[0].split("से ")[1])==null?void 0:M.split(" ")[0];P&&j(P),o.onstart=()=>{m(!0)},o.onend=()=>{m(!1),j(""),T(!1),t&&t(),l()},o.onerror=B=>{console.error("Speech synthesis error:",B),m(!1),j(""),T(!1),l()},speechSynthesis.speak(o)})),[m,d,a,r]),E=n.useCallback(s=>{!f||L||r||(y(!0),f.start(),f.onresult=function(t){const l=t.results[0][0].transcript.trim();Z(l),y(!1),l===s?(h(!0),u("बहुत बढ़िया! चलिए आगे बढ़ते हैं।").then(()=>{h(!1);const o=i+1;o<a.length&&(C(o),v(a[o].text),N(a[o].english))})):u("फिर से कोशिश कीजिए।")},f.onerror=function(t){console.error("Speech recognition error:",t),y(!1),u("फिर से कोशिश कीजिए।")},f.onend=function(){y(!1)})},[f,u,i,a,h,L,r]),I=n.useCallback(async()=>{if(i<a.length&&!r){const s=a[i];if(i===0){await u(s.text);const t=i+1;t<a.length&&(C(t),v(a[t].text),N(a[t].english))}else await u(s.text),await new Promise(t=>setTimeout(t,500)),await u("मेरे बाद दोहराएँ"),setTimeout(()=>{E(s.expected)},500)}},[i,a,u,E,r]);n.useEffect(()=>{let s=!0;if(!S&&a.length>0&&i===0&&!r){const t=setTimeout(()=>{s&&I()},1e3);return()=>{s=!1,clearTimeout(t)}}},[S,a,i,I,r]);const q=s=>{if(!w)return s;const t=s.split(w);return e.jsx(e.Fragment,{children:t.map((l,o)=>e.jsxs(J.Fragment,{children:[l,o<t.length-1&&e.jsx("span",{className:"text-orange-500 font-bold",children:w})]},o))})};return S?e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-white",children:[e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-blue-500 rounded-full border-t-transparent"}),e.jsx("p",{className:"mt-4 text-gray-800",children:"Loading lesson..."})]}):R?e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-white",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:"Error Loading Lesson"}),e.jsx("p",{className:"text-red-500 mb-4",children:R}),e.jsx("button",{onClick:()=>p("/"),className:"rounded-full bg-white p-4 shadow-md hover:shadow-lg transition-transform hover:-translate-y-1",children:e.jsx(O,{className:"w-6 h-6"})})]}):e.jsx("div",{className:"bg-white min-h-screen",children:e.jsxs("div",{className:"relative isolate px-6 pt-14 lg:px-8",children:[e.jsxs("div",{className:"absolute inset-x-0 -top-40 -z-10 transform-gpu overflow-hidden blur-3xl sm:-top-80","aria-hidden":"true",children:[e.jsx("div",{className:"relative left-[calc(50%-11rem)] aspect-[1155/678] w-[36.125rem] -translate-x-1/2 rotate-[30deg] bg-gradient-to-tr from-[#ff80b5] to-[#9089fc] opacity-30 sm:left-[calc(50%-30rem)] sm:w-[72.1875rem]",style:{clipPath:"polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)"}}),e.jsx("div",{className:"relative right-[calc(50%-11rem)] aspect-[1155/678] w-[36.125rem] translate-x-1/2 rotate-[-30deg] bg-gradient-to-tr from-[#ff80b5] to-[#9089fc] opacity-30 sm:right-[calc(50%-30rem)] sm:w-[72.1875rem]",style:{clipPath:"polygon(25.9% 44.1%, 0% 61.6%, 2.5% 26.9%, 14.5% 0.1%, 19.3% 2%, 27.5% 32.5%, 39.8% 62.4%, 47.6% 68.1%, 52.5% 58.3%, 54.8% 34.5%, 72.5% 76.7%, 99.9% 64.9%, 82.1% 100%, 72.4% 76.8%, 23.9% 97.7%, 25.9% 44.1%)"}})]}),e.jsx("div",{className:"flex min-h-screen items-start justify-center pt-24",children:e.jsxs("div",{className:"w-full max-w-4xl mx-auto flex flex-col items-center",children:[e.jsxs("div",{className:"relative w-[400px] h-[400px] rounded-full overflow-hidden bg-gray-100 shadow-lg mb-8",children:[e.jsx("div",{className:"absolute inset-0",children:e.jsx(V,{cameraPosition:[0,2,8],targetPosition:[0,0,0],fov:45,enableZoom:!1,minZoom:2,maxZoom:10,initialScale:4.5})}),x&&e.jsx(se,{currentLesson:i,lessons:a})]}),e.jsxs("div",{className:"flex justify-center gap-6 mb-8",children:[e.jsx("button",{onClick:I,className:"bg-orange-500 text-white p-4 rounded-full hover:bg-orange-600 transition-colors",disabled:r,children:e.jsx(te,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>{var s;return E((s=a[i])==null?void 0:s.expected)},className:"bg-blue-500 text-white p-4 rounded-full hover:bg-blue-600 transition-colors",disabled:L||r,children:e.jsx(D,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>{p("/frog")},className:"bg-purple-500 text-white p-4 rounded-full hover:bg-purple-600 transition-colors",children:e.jsx(X,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"w-full bg-gray-200 h-2 rounded-full mb-4",children:e.jsx("div",{className:"bg-orange-500 h-full rounded-full transition-all duration-300",style:{width:`${i/a.length*100}%`}})}),e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:q($)}),e.jsx("p",{className:"text-lg text-gray-600",children:A})]})]})]})})]})})}export{oe as default};
